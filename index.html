<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Riparazione Certificata â€” Prenota la tua riparazione | Intec Italia</title>
<meta name="description" content="Centro riparazioni Samsung certificato a Cologno Monzese. Prenota online in 4 minuti. Ritiro a domicilio disponibile. Ricambi originali, garanzia 90 giorni.">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300&family=Noto+Sans+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SAMSUNG ONE UI REPAIR â€” Design System
   Ispirato alle immagini di riferimento
   â”€ Sfondo bianco puro
   â”€ Titoli 800 weight, enormi
   â”€ CTA pillola nera border-radius:50px
   â”€ Cards: ombra leggera, radius 20px, no bordi
   â”€ Inputs: bordo grigio, radius 12px
   â”€ Header fisso con â† titolo [N/N]
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

:root {
  --black:   #1C1C1C;
  --white:   #FFFFFF;
  --grey-bg: #F5F5F5;
  --grey-lt: #F0F0F0;
  --grey-md: #E0E0E0;
  --grey-txt:#888888;
  --grey-lbl:#555555;
  --error:   #CC0000;
  --success: #007A4D;
  --radius-card: 20px;
  --radius-input: 12px;
  --radius-btn:   50px;
  --sans: 'Noto Sans','SamsungOne',-apple-system,sans-serif;
  --mono: 'Noto Sans Mono','Courier New',monospace;
  --shadow-card: 0 2px 16px rgba(0,0,0,0.08);
  --shadow-btn:  0 4px 20px rgba(0,0,0,0.18);
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body {
  font-family: var(--sans);
  background: var(--white);
  color: var(--black);
  min-height: 100vh;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
}

/* â”€â”€ TOPNAV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.topnav {
  position: fixed; top: 0; left: 0; right: 0; z-index: 100;
  background: var(--white);
  border-bottom: 1px solid var(--grey-md);
  height: 56px;
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 20px;
}
.logo { display: flex; align-items: center; gap: 10px; }
.logo-badge {
  background: var(--black); color: var(--white);
  padding: 5px 11px; border-radius: 6px;
  font-size: 12px; font-weight: 800; letter-spacing: 1px;
}
.logo-text { font-size: 13px; color: var(--grey-txt); font-weight: 500; }
.nav-phone {
  font-size: 13px; color: var(--grey-txt);
  text-decoration: none; font-weight: 600;
  display: flex; align-items: center; gap: 4px;
}
.nav-phone:hover { color: var(--black); }

/* â”€â”€ PROGRESS LINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.progress-bar-wrap {
  position: fixed; top: 56px; left: 0; right: 0; z-index: 99;
  background: var(--grey-md); height: 2px;
}
.progress-bar-fill {
  height: 100%; background: var(--black);
  transition: width 0.4s ease;
}

/* â”€â”€ MAIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.main { max-width: 480px; margin: 0 auto; padding: 68px 20px 80px; }

/* â”€â”€ HERO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.hero { padding: 28px 0 8px; }
.hero-eye { display: none; } /* nascosto: usiamo il titolo grande diretto */
.hero h1 {
  font-size: clamp(32px, 8vw, 44px);
  font-weight: 800;
  line-height: 1.1;
  letter-spacing: -1px;
  color: var(--black);
  margin-bottom: 10px;
}
.hero h1 em { font-style: normal; color: var(--black); }
.hero-sub {
  font-size: 15px; color: var(--grey-txt);
  line-height: 1.55; margin-bottom: 20px;
}
.hero-badges {
  display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 6px;
}
.hero-badge {
  font-size: 12px; font-weight: 500; color: var(--grey-lbl);
  background: var(--grey-lt);
  padding: 5px 12px; border-radius: 50px;
  display: inline-flex; align-items: center; gap: 4px;
}

/* â”€â”€ STEP BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.step-bar { display: none; } /* rimpiazzato dall'header step */

/* â”€â”€ STEP PANEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.step-panel { display: none; }
.step-panel.active { display: block; }

/* â”€â”€ STEP HEADER (sopra ogni step) â”€â”€â”€â”€â”€â”€â”€â”€ */
.step-hdr {
  display: flex; align-items: center; justify-content: space-between;
  padding: 18px 0 20px;
  border-bottom: 1px solid var(--grey-md);
  margin-bottom: 24px;
}
.step-hdr-back {
  font-size: 22px; cursor: pointer; color: var(--black);
  background: none; border: none; padding: 4px 8px; margin-left: -8px;
  line-height: 1;
}
.step-hdr-title {
  font-size: 15px; font-weight: 700; color: var(--black);
  position: absolute; left: 50%; transform: translateX(-50%);
}
.step-hdr-count {
  font-size: 14px; font-weight: 600; color: var(--grey-txt);
  font-family: var(--mono);
}

/* â”€â”€ CARD (no-border, shadow) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.card {
  background: transparent;
  border: none; border-radius: 0;
  padding: 0; box-shadow: none;
  margin-bottom: 0;
  animation: fadeUp 0.25s ease both;
}
@keyframes fadeUp {
  from { opacity:0; transform: translateY(10px); }
  to   { opacity:1; transform: translateY(0); }
}
.card-title {
  font-size: 26px; font-weight: 800;
  letter-spacing: -0.5px; line-height: 1.2;
  margin-bottom: 6px; color: var(--black);
}
.card-sub {
  font-size: 14px; color: var(--grey-txt);
  margin-bottom: 22px; line-height: 1.5;
}

/* â”€â”€ SERVICE CARDS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.service-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px; }
.service-card {
  background: var(--grey-bg);
  border-radius: var(--radius-card);
  padding: 18px 16px 20px;
  cursor: pointer; transition: all 0.2s;
  text-align: left; position: relative; overflow: hidden;
  border: 2px solid transparent;
  user-select: none; box-shadow: var(--shadow-card);
}
.service-card * { pointer-events: none; }
.service-card:hover { background: #EBEBEB; }
.service-card.selected {
  background: var(--black);
  border-color: var(--black);
}
.service-card.selected .svc-name,
.service-card.selected .svc-desc { color: var(--white); }
.service-card.selected .svc-icon { filter: invert(1); }
.service-card.selected::after {
  content:'âœ“'; position: absolute; top:10px; right:12px;
  width:20px; height:20px; background: var(--white); color: var(--black);
  border-radius: 50%; font-size: 11px; display:flex;
  align-items:center; justify-content:center; font-weight:800;
}
.svc-icon { font-size: 28px; margin-bottom: 10px; display: block; }
.svc-name { font-size: 18px; font-weight: 800; margin-bottom: 6px; color: var(--black); line-height: 1.2; }
.svc-desc { font-size: 12px; color: var(--grey-txt); line-height: 1.4; }

/* â”€â”€ DEVICE GRID â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.device-grid {
  display: grid; grid-template-columns: repeat(3, 1fr);
  gap: 10px; margin-bottom: 20px;
}
.device-item {
  background: var(--grey-bg);
  border-radius: 16px; border: 2px solid transparent;
  padding: 14px 8px 12px; cursor: pointer;
  transition: all 0.2s; text-align: center; user-select: none;
  box-shadow: var(--shadow-card);
}
.device-item * { pointer-events: none; }
.device-item:hover { background: #EBEBEB; }
.device-item.selected { background: var(--black); border-color: var(--black); }
.device-item.selected .dev-name { color: var(--white); }
.device-item.selected .dev-emoji { filter: invert(1) brightness(2); }
.dev-emoji { font-size: 28px; display: block; margin-bottom: 6px; }
.dev-name { font-size: 12px; font-weight: 700; color: var(--black); }

/* â”€â”€ FORM ELEMENTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.form-group { margin-bottom: 16px; }
.form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
label {
  display: block; font-size: 13px; font-weight: 600;
  color: var(--grey-lbl); margin-bottom: 6px; letter-spacing: 0;
  text-transform: none;
}
label .req { color: var(--error); }
label .opt { color: var(--grey-txt); font-weight: 400; font-size: 12px; }
input, select, textarea {
  width: 100%; padding: 14px 16px;
  border: 1.5px solid var(--grey-md);
  border-radius: var(--radius-input);
  font-family: var(--sans); font-size: 16px; color: var(--black);
  background: var(--white); transition: border-color 0.15s;
  appearance: none; outline: none;
}
input:focus, select:focus, textarea:focus {
  border-color: var(--black);
  box-shadow: 0 0 0 3px rgba(28,28,28,0.08);
}
input::placeholder, textarea::placeholder { color: var(--grey-txt); font-size: 15px; }
input.error, select.error, textarea.error {
  border-color: var(--error);
}
.field-err { font-size: 12px; color: var(--error); margin-top: 5px; display: none; }
.field-err.show { display: block; }
textarea { resize: vertical; min-height: 90px; line-height: 1.55; }
select {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%23888' stroke-width='1.8' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");
  background-repeat: no-repeat; background-position: right 14px center;
  padding-right: 40px; cursor: pointer;
}

/* â”€â”€ AUTOCOMPLETE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.model-wrap { position: relative; }
.model-ico {
  position: absolute; left: 14px; top: 50%;
  transform: translateY(-50%); font-size: 16px;
  pointer-events: none; color: var(--grey-txt);
}
.model-wrap input { padding-left: 42px; }
.model-sugg {
  position: absolute; top: calc(100% + 4px); left: 0; right: 0;
  background: var(--white); border: 1.5px solid var(--grey-md);
  border-radius: 16px; box-shadow: 0 8px 24px rgba(0,0,0,0.12);
  z-index: 50; max-height: 200px; overflow-y: auto; display: none;
  overflow: hidden;
}
.model-sugg.show { display: block; }
.sugg-item {
  padding: 13px 16px; font-size: 15px; cursor: pointer;
  transition: background 0.12s; border-bottom: 1px solid var(--grey-lt);
}
.sugg-item:last-child { border-bottom: none; }
.sugg-item:hover { background: var(--grey-lt); }
.sugg-item small { display: block; font-size: 12px; color: var(--grey-txt); margin-top: 2px; }

/* â”€â”€ PROBLEM TAGS (lista checkbox stile foto) */
.prob-grid {
  display: flex; flex-direction: column;
  gap: 0; margin-bottom: 16px;
}
.prob-tag {
  display: flex; align-items: center; gap: 14px;
  padding: 15px 4px; font-size: 16px; cursor: pointer;
  border-bottom: 1px solid var(--grey-lt);
  color: var(--black); font-weight: 400;
  transition: background 0.1s; background: transparent;
  border-radius: 0; border-top: none; border-left: none; border-right: none;
  position: relative;
}
.prob-tag:first-child { border-top: 1px solid var(--grey-lt); }
.prob-tag::before {
  content: '';
  width: 22px; height: 22px; flex-shrink: 0;
  border: 2px solid var(--grey-md); border-radius: 5px;
  background: var(--white); transition: all 0.15s;
}
.prob-tag.sel::before {
  background: var(--black); border-color: var(--black);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Cpath d='M4 10l5 5 7-9' stroke='%23fff' stroke-width='2.5' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
  background-size: 14px; background-repeat: no-repeat; background-position: center;
}
.prob-tag:hover { background: var(--grey-lt); }
.prob-tag span { font-size: 20px; }

/* â”€â”€ DATE CHIPS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.date-grid {
  display: grid; grid-template-columns: repeat(4, 1fr);
  gap: 8px; margin-bottom: 14px;
}
.date-chip {
  border: 1.5px solid var(--grey-md); border-radius: 14px;
  padding: 10px 4px; cursor: pointer; transition: all 0.18s;
  text-align: center; background: var(--white);
}
.date-chip:hover { border-color: var(--black); background: var(--grey-lt); }
.date-chip.sel { background: var(--black); border-color: var(--black); }
.dc-day { font-size: 10px; color: var(--grey-txt); text-transform: uppercase; font-weight: 600; letter-spacing: 0.3px; }
.dc-num { font-size: 22px; font-weight: 800; line-height: 1.1; margin: 2px 0; color: var(--black); }
.dc-mon { font-size: 10px; color: var(--grey-txt); font-weight: 500; }
.date-chip.sel .dc-day, .date-chip.sel .dc-num, .date-chip.sel .dc-mon { color: var(--white); }

/* â”€â”€ TIME CHIPS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.time-grid {
  display: grid; grid-template-columns: repeat(4, 1fr);
  gap: 8px;
}
.time-chip {
  border: 1.5px solid var(--grey-md); border-radius: 14px;
  padding: 12px 4px; cursor: pointer; transition: all 0.18s;
  text-align: center; font-size: 14px; font-family: var(--mono);
  font-weight: 700; color: var(--black); background: var(--white);
}
.time-chip:hover { border-color: var(--black); background: var(--grey-lt); }
.time-chip.sel { background: var(--black); border-color: var(--black); color: var(--white); }
.time-chip.unavail { opacity: 0.3; cursor: not-allowed; }

/* â”€â”€ TOGGLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.toggle-row {
  display: flex; align-items: center; justify-content: space-between;
  padding: 14px 0; border-bottom: 1px solid var(--grey-lt);
  cursor: pointer;
}
.toggle-info .tl { font-size: 15px; font-weight: 600; color: var(--black); }
.toggle-info .td { font-size: 12px; color: var(--grey-txt); margin-top: 2px; }
.tog-sw {
  width: 44px; height: 24px; background: var(--grey-md);
  border-radius: 12px; position: relative; flex-shrink: 0;
  transition: background 0.2s;
}
.tog-sw.on { background: var(--black); }
.tog-sw::after {
  content:''; position: absolute; width: 18px; height: 18px;
  background: white; border-radius: 50%; top: 3px; left: 3px;
  transition: left 0.2s; box-shadow: 0 1px 4px rgba(0,0,0,0.2);
}
.tog-sw.on::after { left: 23px; }

/* â”€â”€ NOTICE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.notice {
  font-size: 13px; color: var(--grey-lbl); line-height: 1.55;
  padding: 12px 14px; background: var(--grey-lt);
  border-radius: 12px; margin-top: 10px;
}
.notice a { color: var(--black); font-weight: 600; text-decoration: none; }
.notice.warning { background: #FFF8E6; color: #7A4500; }

/* â”€â”€ CHECKBOX â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.check-wrap {
  display: flex; align-items: flex-start; gap: 12px;
  cursor: pointer; margin-top: 16px; padding: 4px 0;
}
.check-wrap input[type="checkbox"] {
  width: 20px; height: 20px; flex-shrink: 0;
  margin-top: 2px; accent-color: var(--black); cursor: pointer;
}
.check-lbl {
  font-size: 13px; color: var(--grey-lbl); line-height: 1.6;
}
.check-lbl a { color: var(--black); font-weight: 600; text-decoration: none; }

/* â”€â”€ STRIPE SECTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.stripe-section {
  background: var(--grey-lt); border-radius: 16px;
  padding: 18px; margin-bottom: 14px; border: none;
}
.stripe-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 16px;
}
.stripe-title { font-size: 13px; font-weight: 700; color: var(--grey-lbl); }
.stripe-badges { display: flex; gap: 5px; align-items: center; }
.stripe-badge {
  height: 22px; padding: 0 7px; border-radius: 4px;
  border: 1px solid var(--grey-md); background: var(--white);
  display: flex; align-items: center;
  font-size: 10px; font-weight: 800; color: var(--grey-lbl);
}
.stripe-badge.visa { color: #1a1f71; }
.card-number-row { display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 10px; }
.stripe-note {
  font-size: 12px; color: var(--grey-txt); margin-top: 12px;
  display: flex; align-items: flex-start; gap: 6px; line-height: 1.45;
}

/* â”€â”€ PAYMENT INFO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.payment-info {
  background: #E8F5EF; border-radius: 14px;
  padding: 14px 16px; margin-bottom: 16px;
  display: flex; gap: 10px; align-items: flex-start;
}
.payment-info-icon { font-size: 18px; flex-shrink: 0; margin-top: 1px; }
.payment-info-text { font-size: 13px; color: #005530; line-height: 1.55; }
.payment-info-text strong { font-weight: 700; }

/* â”€â”€ RECAP GRID â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.recap-grid {
  background: var(--grey-lt); border-radius: 16px;
  overflow: hidden; margin-bottom: 18px;
}
.recap-row {
  display: grid; grid-template-columns: 110px 1fr;
  border-bottom: 1px solid var(--white);
}
.recap-row:last-child { border-bottom: none; }
.recap-k {
  padding: 11px 14px; font-size: 11px; font-weight: 700;
  text-transform: uppercase; color: var(--grey-txt);
  background: transparent; letter-spacing: 0.4px;
  display: flex; align-items: center;
}
.recap-v {
  padding: 11px 14px; font-size: 13px; color: var(--black);
  display: flex; align-items: center; line-height: 1.45;
  background: transparent;
}
.badge {
  display: inline-flex; align-items: center;
  padding: 2px 8px; border-radius: 50px; font-size: 11px;
  font-weight: 700; background: var(--grey-md); color: var(--black);
}

/* â”€â”€ DIVIDER LABEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.div-lbl {
  display: flex; align-items: center; gap: 10px;
  font-size: 11px; color: var(--grey-txt); font-weight: 700;
  text-transform: uppercase; letter-spacing: 1px; margin: 18px 0 12px;
}
.div-lbl::before, .div-lbl::after {
  content:''; flex:1; height:1px; background: var(--grey-md);
}

/* â”€â”€ BUTTONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.btn-primary {
  width: 100%; padding: 16px 28px;
  background: var(--black); color: var(--white);
  border: none; border-radius: var(--radius-btn);
  font-family: var(--sans); font-size: 17px; font-weight: 700;
  cursor: pointer; transition: all 0.2s;
  display: flex; align-items: center; justify-content: center; gap: 10px;
  box-shadow: var(--shadow-btn); letter-spacing: 0;
}
.btn-primary:hover { background: #333; box-shadow: 0 6px 24px rgba(0,0,0,0.22); }
.btn-primary:active { background: #000; transform: scale(0.99); }
.btn-primary:disabled { opacity: 0.5; cursor: not-allowed; box-shadow: none; }

.btn-secondary {
  width: 100%; padding: 15px;
  background: transparent; color: var(--black);
  border: 2px solid var(--grey-md); border-radius: var(--radius-btn);
  font-family: var(--sans); font-size: 15px; font-weight: 600;
  cursor: pointer; transition: all 0.18s; margin-top: 10px;
}
.btn-secondary:hover { border-color: var(--black); background: var(--grey-lt); }

.btn-row {
  display: grid; grid-template-columns: auto 1fr; gap: 10px; margin-top: 8px;
}
.btn-back {
  padding: 14px 20px; background: transparent;
  color: var(--grey-lbl); border: 2px solid var(--grey-md);
  border-radius: var(--radius-btn); font-family: var(--sans);
  font-size: 15px; cursor: pointer; transition: all 0.15s;
  display: flex; align-items: center; gap: 6px; white-space: nowrap;
  font-weight: 600;
}
.btn-back:hover { border-color: var(--black); color: var(--black); }

/* â”€â”€ SUCCESS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.success-screen { text-align: center; padding: 20px 0; }
.succ-icon {
  width: 72px; height: 72px; background: var(--black); border-radius: 50%;
  display: inline-flex; align-items: center; justify-content: center;
  font-size: 32px; margin-bottom: 20px; color: white;
  animation: popIn 0.4s cubic-bezier(0.34,1.56,0.64,1) both;
}
@keyframes popIn {
  from { transform: scale(0); opacity:0; }
  to   { transform: scale(1); opacity:1; }
}
.succ-title {
  font-size: 28px; font-weight: 800; letter-spacing: -0.5px;
  margin-bottom: 8px; color: var(--black);
}
.succ-sub { font-size: 15px; color: var(--grey-txt); margin-bottom: 20px; }
.booking-code {
  display: inline-block; font-family: var(--mono);
  font-size: 22px; font-weight: 800; color: var(--black);
  background: var(--grey-lt); padding: 12px 28px;
  border-radius: 14px; letter-spacing: 2px; margin-bottom: 24px;
}
.next-steps {
  text-align: left; background: var(--grey-lt);
  border-radius: 16px; padding: 18px; margin-bottom: 20px;
}
.ns-title {
  font-size: 11px; font-weight: 800; text-transform: uppercase;
  letter-spacing: 0.8px; color: var(--grey-txt); margin-bottom: 14px;
}
.ns-item {
  display: flex; align-items: flex-start; gap: 12px;
  margin-bottom: 12px; font-size: 14px; line-height: 1.5; color: var(--black);
}
.ns-item:last-child { margin-bottom: 0; }
.ns-dot {
  width: 22px; height: 22px; background: var(--black); color: white;
  border-radius: 50%; display: flex; align-items: center;
  justify-content: center; font-size: 11px; font-weight: 800;
  flex-shrink: 0; margin-top: 1px;
}

/* â”€â”€ TRUST ROW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.trust-row {
  display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;
  margin-top: 28px; padding: 20px 0;
  border-top: 1px solid var(--grey-md);
}
.trust-item {
  font-size: 12px; color: var(--grey-txt); font-weight: 500;
  display: flex; align-items: center; gap: 4px;
}

/* â”€â”€ FLOATING HELP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.floating-help {
  position: fixed; bottom: 24px; right: 20px;
  background: var(--black); color: white;
  padding: 12px 20px; border-radius: 50px;
  font-size: 14px; font-weight: 700;
  display: flex; align-items: center; gap: 8px;
  box-shadow: 0 6px 24px rgba(0,0,0,0.2);
  text-decoration: none; z-index: 50; transition: all 0.2s;
}
.floating-help:hover { background: var(--grey-lt); color: var(--black); }

/* â”€â”€ RESPONSIVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@media (max-width: 480px) {
  .main { padding: 60px 16px 70px; }
  .card-title { font-size: 24px; }
  .hero h1 { font-size: 30px; }
  .form-row { grid-template-columns: 1fr; }
  .date-grid { grid-template-columns: repeat(3, 1fr); }
  .time-grid { grid-template-columns: repeat(3, 1fr); }
  .card-number-row { grid-template-columns: 1fr; }
  .step-hdr-title { font-size: 14px; }
  .recap-row { grid-template-columns: 90px 1fr; }
  .btn-primary { font-size: 16px; padding: 15px; }
  .service-grid { gap: 10px; }
}
</style>
</head>
<body>

<nav class="topnav">
  <div class="logo">
    <span class="logo-badge">INTECITALIA</span>
    <span class="logo-text">Samsung Repairs</span>
  </div>
  <a href="tel:+390227306248" class="nav-phone">ğŸ“ 02 27306248</a>
</nav>
<div class="progress-bar-wrap">
  <div class="progress-bar-fill" id="pb" style="width:16%"></div>
</div>

<main class="main">
  <div class="hero">
    <div class="hero-eye">Riparazione Certificata Â· Cologno Monzese</div>
    <h1>Ripara il tuo<br>dispositivo<br><em>Samsung</em></h1>
    <p class="hero-sub">Smartphone, tablet, PC, Galaxy Buds & Ring.<br>Tecnici certificati, ricambi originali, ritiro a domicilio.</p>
    <div class="hero-badges">
      <span class="hero-badge">ğŸ… Certificati Samsung</span>
      <span class="hero-badge">ğŸ›¡ï¸ Garanzia 90gg</span>
      <span class="hero-badge">ğŸ”§ Ricambi Originali</span>
      <span class="hero-badge">ğŸ”’ Paghi solo a riparazione ultimata</span>
    </div>
  </div>

  <!-- STEP BAR -->
  <div class="step-bar">
    <div class="step-item active" id="si1"><div class="step-dot">1</div><div class="step-lbl">Servizio</div></div>
    <div class="step-item" id="si2"><div class="step-dot">2</div><div class="step-lbl">Dispositivo</div></div>
    <div class="step-item" id="si3"><div class="step-dot">3</div><div class="step-lbl">Problema</div></div>
    <div class="step-item" id="si4"><div class="step-dot">4</div><div class="step-lbl">Dati</div></div>
    <div class="step-item" id="si5"><div class="step-dot">5</div><div class="step-lbl">Pagamento</div></div>
    <div class="step-item" id="si6"><div class="step-dot">âœ“</div><div class="step-lbl">Conferma</div></div>
  </div>

  <!-- â”€â”€ STEP 1: SERVIZIO â”€â”€ -->
  <div class="step-panel active" id="step1">
    <div class="step-hdr" style="position:relative;">
      <span class="step-hdr-back" onclick="next(0)" style="visibility:hidden;">â†</span>
      <span class="step-hdr-title">Prenota riparazione</span>
      <span class="step-hdr-count">[1/5]</span>
    </div>
    <div class="card">
      <div class="card-title">Come vuoi portarci il dispositivo?</div>
      <div class="card-sub">Scegli l'opzione piÃ¹ comoda per te</div>
      <div class="service-grid">
        <div class="service-card" onclick="pickService('store',this)">
          <span class="svc-icon">ğŸª</span>
          <div class="svc-name">In Negozio</div>
          <div class="svc-desc">âœ“ Gratis<br>âœ“ Immediato</div>
        </div>
        <div class="service-card" onclick="pickService('home',this)">
          <span class="svc-icon">ğŸš</span>
          <div class="svc-name">A Domicilio</div>
          <div class="svc-desc">âœ“ Comodo<br>âœ“ Sicuro</div>
        </div>
      </div>
      <div id="info-store" class="notice" style="display:none; margin-bottom:14px;">
        ğŸ“ <strong>Intec Italia</strong> â€” Via Peppino Rossi 13, 20093 Cologno Monzese MI<br>
        Lunâ€“Ven 9:00â€“18:00
      </div>
      <div id="info-home" class="notice" style="display:none; margin-bottom:14px;">
        ğŸš Il nostro corriere passa nella fascia oraria selezionata. Riconsegna entro 24â€“48h dal completamento. <strong>Spedizione inclusa.</strong>
      </div>
      <div class="div-lbl">scegli data e orario</div>
      <div class="date-grid" id="dateGrid"></div>
      <div class="div-lbl">fascia oraria</div>
      <div class="time-grid" id="timeGrid"></div>
      <div style="margin-top:22px;">
        <button class="btn-primary" onclick="next(2)">Continua â†’</button>
      </div>
    </div>
  </div>

  <!-- â”€â”€ STEP 2: DISPOSITIVO â”€â”€ -->
  <div class="step-panel" id="step2">
    <div class="step-hdr" style="position:relative;">
      <button class="step-hdr-back" onclick="next(1)">â†</button>
      <span class="step-hdr-title">Selezione dispositivo</span>
      <span class="step-hdr-count">[2/5]</span>
    </div>
    <div class="card">
      <div class="card-title">Che dispositivo hai?</div>
      <div class="card-sub">Seleziona categoria e modello del tuo Samsung</div>
      <div class="device-grid">
        <div class="device-item" onclick="pickDevice('Smartphone','ğŸ“±',this)"><span class="dev-emoji">ğŸ“±</span><div class="dev-name">Smartphone</div></div>
        <div class="device-item" onclick="pickDevice('Tablet','ğŸ“Ÿ',this)"><span class="dev-emoji">ğŸ“Ÿ</span><div class="dev-name">Tablet</div></div>
        <div class="device-item" onclick="pickDevice('PC / Laptop','ğŸ–¥ï¸',this)"><span class="dev-emoji">ğŸ–¥ï¸</span><div class="dev-name">PC / Laptop</div></div>
        <div class="device-item" onclick="pickDevice('Galaxy Buds','ğŸ§',this)"><span class="dev-emoji">ğŸ§</span><div class="dev-name">Galaxy Buds</div></div>
        <div class="device-item" onclick="pickDevice('Galaxy Ring','ğŸ’',this)"><span class="dev-emoji">ğŸ’</span><div class="dev-name">Galaxy Ring</div></div>
        <div class="device-item" onclick="pickDevice('Altro','ğŸ“¦',this)"><span class="dev-emoji">ğŸ“¦</span><div class="dev-name">Altro</div></div>
      </div>
      <div class="form-group">
        <label>Modello <span class="req">*</span></label>
        <div class="model-wrap">
          <span class="model-ico">ğŸ”</span>
          <input type="text" id="modelInput" placeholder="es. Galaxy S24 Ultra, Tab S9+" oninput="filterModels(this)" autocomplete="off">
          <div class="model-sugg" id="modelSugg"></div>
        </div>
        <div class="field-err" id="modelErr">Inserisci il modello del dispositivo</div>
      </div>
      <div class="form-group">
        <label>Numero Seriale / IMEI <span class="opt">(opzionale â€” trovi in Impostazioni â€º Info telefono)</span></label>
        <input type="text" id="serialInput" placeholder="es. 354812023456789">
      </div>
      <div style="margin-top:8px;">
        <button class="btn-primary" onclick="next(3)">Continua â†’</button>
      </div>
    </div>
  </div>

  <!-- â”€â”€ STEP 3: PROBLEMA â”€â”€ -->
  <div class="step-panel" id="step3">
    <div class="step-hdr" style="position:relative;">
      <button class="step-hdr-back" onclick="next(2)">â†</button>
      <span class="step-hdr-title">Descrivi il problema</span>
      <span class="step-hdr-count">[3/5]</span>
    </div>
    <div class="card">
      <div class="card-title">Qual Ã¨ il problema?</div>
      <div class="card-sub">Seleziona i problemi riscontrati (puoi sceglierne piÃ¹ di uno)</div>
      <div class="prob-grid" id="probGrid"></div>
      <div class="form-group">
        <label>Descrizione aggiuntiva <span class="opt">(consigliato)</span></label>
        <textarea id="probDesc" placeholder="Descrivi quando Ã¨ successo, se c'Ã¨ stato un danno fisico, se il dispositivo si accende ancora..."></textarea>
      </div>
      <div class="div-lbl">informazioni extra per il tecnico</div>
      <div class="toggle-row" onclick="togWarranty()">
        <div class="toggle-info"><div class="tl">ğŸ›¡ï¸ Dispositivo in garanzia Samsung?</div><div class="td">Aiuta il tecnico a preparare la documentazione corretta</div></div>
        <div class="tog-sw" id="warSw"></div>
      </div>
      <div class="toggle-row" onclick="togPin()">
        <div class="toggle-info"><div class="tl">ğŸ” Fornisci PIN di sblocco</div><div class="td">Facoltativo â€” cifrato AES-256, eliminato automaticamente dopo 7 giorni</div></div>
        <div class="tog-sw" id="pinSw"></div>
      </div>
      <div id="pinField" style="display:none;" class="form-group">
        <div class="notice warning" style="margin-bottom:8px;">âš ï¸ Il PIN viene cifrato con AES-256 e usato solo per la diagnosi. Viene eliminato automaticamente entro 7 giorni o al completamento della riparazione. Non verrÃ  mai condiviso.</div>
        <label>PIN / Password <span class="opt">(cifrato in transito e in storage)</span></label>
        <input type="password" id="pinInput" placeholder="Il tuo PIN o password" autocomplete="new-password">
      </div>
      <div style="margin-top:20px;">
        <button class="btn-primary" onclick="next(4)">Continua â†’</button>
      </div>
    </div>
  </div>

  <!-- â”€â”€ STEP 4: DATI CLIENTE â”€â”€ -->
  <div class="step-panel" id="step4">
    <div class="step-hdr" style="position:relative;">
      <button class="step-hdr-back" onclick="next(3)">â†</button>
      <span class="step-hdr-title">I tuoi dati</span>
      <span class="step-hdr-count">[4/5]</span>
    </div>
    <div class="card">
      <div class="card-title">I tuoi dati di contatto</div>
      <div class="card-sub">Useremo questi dati per aggiornarti sullo stato della riparazione e inviarti il preventivo</div>
      <div class="form-row">
        <div class="form-group">
          <label>Nome <span class="req">*</span></label>
          <input type="text" id="fName" placeholder="Mario" autocomplete="given-name">
          <div class="field-err" id="fNameErr">Campo obbligatorio</div>
        </div>
        <div class="form-group">
          <label>Cognome <span class="req">*</span></label>
          <input type="text" id="lName" placeholder="Rossi" autocomplete="family-name">
          <div class="field-err" id="lNameErr">Campo obbligatorio</div>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label>Email <span class="req">*</span></label>
          <input type="email" id="emailF" placeholder="mario@email.it" autocomplete="email">
          <div class="field-err" id="emailErr">Email non valida</div>
        </div>
        <div class="form-group">
          <label>Telefono <span class="req">*</span></label>
          <input type="tel" id="phoneF" placeholder="+39 333 1234567" autocomplete="tel">
          <div class="field-err" id="phoneErr">Numero non valido</div>
        </div>
      </div>

      <div id="addrSection" style="display:none;">
        <div class="div-lbl">indirizzo ritiro domicilio</div>
        <div class="form-group">
          <label>Via e numero civico <span class="req">*</span></label>
          <input type="text" id="addrF" placeholder="Via Roma 1" autocomplete="street-address">
          <div class="field-err" id="addrErr">Inserisci l'indirizzo completo</div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>CAP <span class="req">*</span></label>
            <input type="text" id="capF" placeholder="00010" maxlength="5" inputmode="numeric">
            <div class="field-err" id="capErr">CAP non valido (5 cifre)</div>
          </div>
          <div class="form-group">
            <label>CittÃ  <span class="req">*</span></label>
            <input type="text" id="cityF" placeholder="Cologno Monzese" autocomplete="address-level2">
            <div class="field-err" id="cityErr">Campo obbligatorio</div>
          </div>
        </div>
        <div class="form-group">
          <label>Note per il corriere <span class="opt">(opzionale)</span></label>
          <input type="text" id="courierF" placeholder="es. Citofono Rossi, scala A, 3Â° piano">
        </div>
      </div>

      <div class="div-lbl">preferenze notifiche</div>
      <div class="toggle-row" onclick="togWA()">
        <div class="toggle-info">
          <div class="tl">ğŸ’¬ Aggiornamenti via WhatsApp</div>
          <div class="td">Ricevi notifiche di stato, preventivo e conferma sul tuo numero. Molto consigliato.</div>
        </div>
        <div class="tog-sw" id="waSw"></div>
      </div>

      <div class="check-wrap">
        <input type="checkbox" id="privCheck" onchange="this.closest('.check-wrap').style.outline='none';document.getElementById('privErr').style.display='none';">
        <label for="privCheck" class="check-lbl">Ho letto e accetto la <a href="#">Privacy Policy</a> e i <a href="#">Termini di Servizio</a>. Confermo che i dati saranno trattati secondo il GDPR (Reg. UE 2016/679) per la gestione della riparazione. <span class="req">*</span></label>
      </div>
      <div id="privErr" style="display:none; font-size:12px; color:var(--error); margin-top:5px;">âš ï¸ Devi accettare la Privacy Policy per continuare</div>

      <div class="notice" style="margin-top:10px;">
        ğŸ”’ Dati protetti secondo il GDPR. Nessuna condivisione con terzi. Puoi richiedere la cancellazione a <a href="mailto:privacy@intecitalia.it">privacy@intecitalia.it</a>
      </div>

      <div style="margin-top:18px;">
        <button class="btn-primary" onclick="next(5)">Continua â†’</button>
      </div>
    </div>
  </div>

  <!-- â”€â”€ STEP 5: PAGAMENTO â”€â”€ -->
  <div class="step-panel" id="step5">
    <div class="step-hdr" style="position:relative;">
      <button class="step-hdr-back" onclick="next(4)">â†</button>
      <span class="step-hdr-title">Metodo di pagamento</span>
      <span class="step-hdr-count">[5/5]</span>
    </div>
    <div class="card">
      <div class="card-title">Metodo di pagamento</div>
      <div class="card-sub">Salviamo la tua carta in modo sicuro â€” <strong>non viene addebitata ora</strong></div>

      <div class="payment-info">
        <span class="payment-info-icon">â„¹ï¸</span>
        <div class="payment-info-text">
          <strong>Come funziona il pagamento posticipato:</strong><br>
          Registriamo la tua carta in modo sicuro tramite Stripe. <strong>L'addebito avviene solo dopo che hai approvato il preventivo e la riparazione Ã¨ completata.</strong> Se rifiuti il preventivo o annulli, non viene addebitato nulla.
        </div>
      </div>

      <div class="stripe-section">
        <div class="stripe-header">
          <span class="stripe-title">ğŸ”’ Dati carta (Stripe Secure)</span>
          <div class="stripe-badges">
            <div class="stripe-badge visa">VISA</div>
            <div class="stripe-badge" style="font-size:8px; background:#333; color:white;">MC</div>
            <div class="stripe-badge" style="color:#0066a1; font-size:8px;">AMEX</div>
          </div>
        </div>
        <div class="form-group">
          <label>Numero carta <span class="req">*</span></label>
          <input type="text" id="cardNum" placeholder="1234 5678 9012 3456" maxlength="19" oninput="fmtCard(this)" inputmode="numeric">
          <div class="field-err" id="cardNumErr">Numero carta non valido</div>
        </div>
        <div class="card-number-row">
          <div class="form-group">
            <label>Nome titolare <span class="req">*</span></label>
            <input type="text" id="cardName" placeholder="Mario Rossi" autocomplete="cc-name">
            <div class="field-err" id="cardNameErr">Campo obbligatorio</div>
          </div>
          <div class="form-group">
            <label>Scadenza <span class="req">*</span></label>
            <input type="text" id="cardExp" placeholder="MM/AA" maxlength="5" oninput="fmtExp(this)" inputmode="numeric">
            <div class="field-err" id="cardExpErr">Data non valida</div>
          </div>
          <div class="form-group">
            <label>CVV <span class="req">*</span></label>
            <input type="text" id="cardCvv" placeholder="123" maxlength="4" inputmode="numeric">
            <div class="field-err" id="cardCvvErr">CVV non valido</div>
          </div>
        </div>
        <div class="stripe-note">
          <span class="stripe-note-icon">ğŸ”</span>
          <span>Crittografia SSL 256-bit Â· PCI DSS Level 1 Â· Gestito da Stripe Â· Nessun dato carta sui nostri server</span>
        </div>
      </div>

      <div class="notice warning">
        âš ï¸ <strong>Nessun addebito ora.</strong> La carta viene salvata in modo sicuro come garanzia. Riceverai il preventivo via WhatsApp/email prima di qualsiasi addebito. Hai il diritto di rifiutare il preventivo senza costi.
      </div>

      <div style="margin-top:18px;">
        <button class="btn-primary" onclick="next(6)">Rivedi il riepilogo â†’</button>
      </div>
    </div>
  </div>

  <!-- â”€â”€ STEP 6: RIEPILOGO â”€â”€ -->
  <div class="step-panel" id="step6">
    <div class="step-hdr" style="position:relative;">
      <button class="step-hdr-back" onclick="next(4)">â†</button>
      <span class="step-hdr-title">Riepilogo</span>
      <span class="step-hdr-count">[âœ“]</span>
    </div>
    <div class="card">
      <div class="card-title">Riepilogo prenotazione</div>
      <div class="card-sub">Controlla tutto prima di confermare</div>
      <div class="recap-grid" id="recapGrid"></div>
      <div class="notice" style="margin-bottom:14px;">
        âœ… Confermando, accetti i <a href="#">Termini di Servizio</a>. Riceverai una conferma via email (e WhatsApp se abilitato) entro pochi secondi. <strong>Nessun addebito fino all'approvazione del preventivo.</strong>
      </div>
      <div id="webhookErr" style="display:none; margin-bottom:14px; padding:12px 14px; background:#FFF5F5; border:1px solid #F5C5C5; border-radius:4px; font-size:12px; color:#8B0000; line-height:1.5;">
        âš ï¸ <strong>Errore di connessione.</strong> Impossibile inviare la prenotazione. Controlla la connessione e riprova, oppure chiamaci al <a href="tel:+390227306248" style="color:#1C1C1C;font-weight:600;">02 27306248</a>.
      </div>
      <button class="btn-primary" id="btnConfirm" onclick="confirm()" style="font-size:16px; padding:16px;">
        âœ… Conferma Prenotazione â€” Paga dopo la riparazione
      </button>
    </div>
  </div>

  <!-- â”€â”€ SUCCESS â”€â”€ -->
  <div class="step-panel" id="stepOK">
    <div class="card">
      <div class="success-screen">
        <div class="succ-icon">âœ“</div>
        <div class="succ-title">Prenotazione confermata!</div>
        <div class="succ-sub">Email di conferma inviata. Codice prenotazione:</div>
        <div class="booking-code" id="bookCode">SR-2025-XXXX</div>
        <div class="next-steps">
          <div class="ns-title">Cosa succede adesso</div>
          <div class="ns-item" id="ns1"><div class="ns-dot">1</div><div id="ns1t"></div></div>
          <div class="ns-item"><div class="ns-dot">2</div><div>Il tecnico diagnostica il problema e ti invia il <strong>preventivo via WhatsApp/email</strong> entro 2 ore lavorative.</div></div>
          <div class="ns-item"><div class="ns-dot">3</div><div>Approvi o rifiuti il preventivo tramite link. Se rifiuti, il dispositivo viene restituito <strong>senza alcun addebito</strong>.</div></div>
          <div class="ns-item"><div class="ns-dot">4</div><div>Riparazione completata â†’ addebito automatico sulla carta salvata â†’ <strong>ricevuta via email</strong>.</div></div>
          <div class="ns-item" id="ns5"><div class="ns-dot">5</div><div id="ns5t"></div></div>
        </div>
        <a href="#" class="btn-primary" style="text-decoration:none; display:inline-flex; margin-bottom:9px; width:100%; justify-content:center;">
          ğŸ“§ Controlla la tua email
        </a>
        <button class="btn-secondary" onclick="location.reload()">Nuova prenotazione</button>
      </div>
    </div>
  </div>

  <div class="trust-row">
    <div class="trust-item">ğŸ… Tecnici Certificati Samsung</div>
    <div class="trust-item">ğŸ”§ Ricambi Originali</div>
    <div class="trust-item">ğŸ›¡ï¸ Garanzia 90 giorni</div>
    <div class="trust-item">ğŸ’³ Paghi dopo la riparazione</div>
    <div class="trust-item">ğŸ”’ GDPR Compliant</div>
  </div>
</main>

<a href="tel:+390227306248" class="floating-help">ğŸ“ Serve aiuto?</a>

<script>
// â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const S = { step:1, serviceType:null, date:null, time:null, device:null, model:'', serial:'',
  problems:[], desc:'', warranty:false, pin:false, pinVal:'',
  fname:'', lname:'', email:'', phone:'', addr:'', cap:'', city:'', courier:'', wa:false };

// â”€â”€â”€ MODEL DB â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const MDL = {
  'Smartphone': [
    {n:'Galaxy S25 Ultra',h:'2025'},{n:'Galaxy S25+',h:'2025'},{n:'Galaxy S25',h:'2025'},
    {n:'Galaxy S24 Ultra',h:'2024'},{n:'Galaxy S24+',h:'2024'},{n:'Galaxy S24',h:'2024'},
    {n:'Galaxy S23 Ultra',h:'2023'},{n:'Galaxy S23+',h:'2023'},{n:'Galaxy S23',h:'2023'},
    {n:'Galaxy S22 Ultra',h:'2022'},{n:'Galaxy A55 5G',h:'2024'},{n:'Galaxy A54 5G',h:'2023'},
    {n:'Galaxy A35',h:'2024'},{n:'Galaxy A25',h:'2023'},{n:'Galaxy A15',h:'2023'},
    {n:'Galaxy Z Fold 6',h:'Foldable 2024'},{n:'Galaxy Z Fold 5',h:'Foldable 2023'},
    {n:'Galaxy Z Flip 6',h:'Flip 2024'},{n:'Galaxy Z Flip 5',h:'Flip 2023'},
    {n:'Galaxy M34',h:'Budget 2023'},{n:'Galaxy M14',h:'Budget 2023'},
  ],
  'Tablet': [
    {n:'Galaxy Tab S9 Ultra',h:'2023'},{n:'Galaxy Tab S9+',h:'2023'},{n:'Galaxy Tab S9',h:'2023'},
    {n:'Galaxy Tab S9 FE',h:'Fan Edition'},{n:'Galaxy Tab S8 Ultra',h:'2022'},
    {n:'Galaxy Tab A9+',h:'Mid-range'},{n:'Galaxy Tab A9',h:'Mid-range'},
    {n:'Galaxy Tab A8',h:'2021'},{n:'Galaxy Tab A7 Lite',h:'2021'},
  ],
  'PC / Laptop': [
    {n:'Galaxy Book4 Ultra',h:'2024'},{n:'Galaxy Book4 Pro 360',h:'2-in-1 2024'},
    {n:'Galaxy Book4 Pro',h:'2024'},{n:'Galaxy Book4',h:'2024'},
    {n:'Galaxy Book3 Ultra',h:'2023'},{n:'Galaxy Book3 360',h:'2023'},
    {n:'Galaxy Book3 Pro',h:'2023'},{n:'Galaxy Book3',h:'2023'},
    {n:'Galaxy Book2 Pro 360',h:'2022'},{n:'Galaxy Book2 Pro',h:'2022'},
  ],
  'Galaxy Buds': [
    {n:'Galaxy Buds3 Pro',h:'2024'},{n:'Galaxy Buds3',h:'2024'},
    {n:'Galaxy Buds2 Pro',h:'2022'},{n:'Galaxy Buds2',h:'2021'},
    {n:'Galaxy Buds FE',h:'Fan Edition'},{n:'Galaxy Buds Live',h:'2020'},
  ],
  'Galaxy Ring': [{n:'Galaxy Ring',h:'2024 â€” Taglia 5â€“13'}],
  'Altro': [{n:'Galaxy Watch 7',h:'2024'},{n:'Galaxy Watch Ultra',h:'2024'},{n:'Galaxy Watch 6',h:'2023'},{n:'Altro dispositivo Samsung',h:''}]
};

const PROBS = {
  default: [
    {i:'ğŸ’¥',l:'Schermo rotto / crepe'},{i:'ğŸ”‹',l:'Batteria scarica / non si carica'},
    {i:'ğŸ“¡',l:'No segnale / WiFi / Bluetooth'},{i:'ğŸ“·',l:'Fotocamera non funziona'},
    {i:'ğŸ”‡',l:'Audio / altoparlante'},{i:'ğŸ’§',l:'Danno da liquidi'},
    {i:'ğŸ”Œ',l:'Porta di ricarica'},{i:'âš¡',l:'Non si accende'},
    {i:'ğŸŒ¡ï¸',l:'Surriscaldamento'},{i:'ğŸ“²',l:'Tasto / pulsante rotto'},
  ],
  'Galaxy Buds': [
    {i:'ğŸ”‡',l:'Audio basso / assente'},{i:'ğŸ”‹',l:'Batteria / custodia'},
    {i:'ğŸ“¡',l:'Connessione Bluetooth'},{i:'ğŸ’§',l:'Danno da acqua / sudore'},
    {i:'ğŸ¤',l:'Microfono'},{i:'ğŸ“¦',l:'Custodia danneggiata'},
  ],
  'Galaxy Ring': [
    {i:'ğŸ”‹',l:'Problema batteria'},{i:'ğŸ“¡',l:'Non si sincronizza'},
    {i:'ğŸŒ¡ï¸',l:'Sensori non accurati'},{i:'ğŸ’§',l:'Danno da acqua'},{i:'ğŸ’¥',l:'Struttura fisica'},
  ],
  'PC / Laptop': [
    {i:'ğŸ’¥',l:'Schermo rotto / display'},{i:'ğŸ”‹',l:'Batteria'},
    {i:'âŒ¨ï¸',l:'Tastiera / trackpad'},{i:'ğŸ¢',l:'Lentezza / prestazioni'},
    {i:'ğŸ”Œ',l:'Porta USB / ricarica'},{i:'ğŸ“¡',l:'WiFi / Bluetooth'},
    {i:'ğŸ’§',l:'Danno da liquidi'},{i:'âš¡',l:'Non si avvia'},
  ]
};

const PROG = {1:16,2:33,3:50,4:66,5:82,6:96,7:100};

// â”€â”€â”€ DATES / TIMES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function initDates() {
  const g = document.getElementById('dateGrid');
  const days = ['Dom','Lun','Mar','Mer','Gio','Ven','Sab'];
  const mths = ['Gen','Feb','Mar','Apr','Mag','Giu','Lug','Ago','Set','Ott','Nov','Dic'];
  const today = new Date();
  let cnt=0, off=1;
  while(cnt<7) {
    const d = new Date(today);
    d.setDate(today.getDate()+off++);
    if(d.getDay()===0) continue;
    const el = document.createElement('div');
    el.className='date-chip';
    el.innerHTML=`<div class="dc-day">${days[d.getDay()]}</div><div class="dc-num">${d.getDate()}</div><div class="dc-mon">${mths[d.getMonth()]}</div>`;
    const label=`${days[d.getDay()]} ${d.getDate()} ${mths[d.getMonth()]}`;
    el.onclick=()=>{document.querySelectorAll('.date-chip').forEach(c=>c.classList.remove('sel'));el.classList.add('sel');S.date=label;};
    g.appendChild(el); cnt++;
  }
}
function initTimes() {
  const g=document.getElementById('timeGrid');
  const slots=['09:00','10:00','11:00','12:00','14:00','15:00','16:00','17:00','18:00'];
  const busy=['11:00','16:00'];
  slots.forEach(t=>{
    const el=document.createElement('div');
    el.className='time-chip'+(busy.includes(t)?' unavail':'');
    el.textContent=t;
    if(!busy.includes(t)) el.onclick=()=>{document.querySelectorAll('.time-chip:not(.unavail)').forEach(c=>c.classList.remove('sel'));el.classList.add('sel');S.time=t;};
    g.appendChild(el);
  });
}

// â”€â”€â”€ SERVICE / DEVICE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function pickService(t,el) {
  document.querySelectorAll('.service-card').forEach(c=>c.classList.remove('selected'));
  el.classList.add('selected'); S.serviceType=t;
  document.getElementById('info-store').style.display=t==='store'?'block':'none';
  document.getElementById('info-home').style.display=t==='home'?'block':'none';
  document.getElementById('addrSection').style.display=t==='home'?'block':'none';
}
function pickDevice(n,e,el) {
  document.querySelectorAll('.device-item').forEach(d=>d.classList.remove('selected'));
  el.classList.add('selected'); S.device=n;
  document.getElementById('modelInput').value='';
  document.getElementById('modelSugg').classList.remove('show');
}

// â”€â”€â”€ AUTOCOMPLETE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function filterModels(inp) {
  S.model=inp.value;
  const cat=S.device||'Smartphone';
  const list=MDL[cat]||[];
  const q=inp.value.toLowerCase();
  const sg=document.getElementById('modelSugg');
  if(q.length<1){sg.classList.remove('show');return;}
  const m=list.filter(x=>x.n.toLowerCase().includes(q));
  if(!m.length){sg.classList.remove('show');return;}
  sg.innerHTML=m.map(x=>`<div class="sugg-item" onclick="pickModel('${x.n}')">${x.n}<small>${x.h}</small></div>`).join('');
  sg.classList.add('show');
}
function pickModel(n){document.getElementById('modelInput').value=n;S.model=n;document.getElementById('modelSugg').classList.remove('show');}
document.addEventListener('click',e=>{if(!e.target.closest('.model-wrap'))document.getElementById('modelSugg').classList.remove('show');});

// â”€â”€â”€ PROBLEMS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderProbs() {
  const cat=S.device;
  const list=PROBS[cat]||PROBS.default;
  const g=document.getElementById('probGrid');
  g.innerHTML=''; S.problems=[];
  list.forEach(p=>{
    const el=document.createElement('div');
    el.className='prob-tag';
    el.innerHTML=`<span>${p.i}</span>${p.l}`;
    el.onclick=()=>{
      el.classList.toggle('sel');
      if(el.classList.contains('sel'))S.problems.push(p.l);
      else S.problems=S.problems.filter(x=>x!==p.l);
    };
    g.appendChild(el);
  });
}

// â”€â”€â”€ TOGGLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function togWarranty(){S.warranty=!S.warranty;document.getElementById('warSw').classList.toggle('on',S.warranty);}
function togPin(){
  S.pin=!S.pin;
  document.getElementById('pinSw').classList.toggle('on',S.pin);
  document.getElementById('pinField').style.display=S.pin?'block':'none';
}
function togWA(){S.wa=!S.wa;document.getElementById('waSw').classList.toggle('on',S.wa);}

// â”€â”€â”€ CARD FORMAT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function fmtCard(el){let v=el.value.replace(/\D/g,'').substring(0,16);el.value=v.replace(/(.{4})/g,'$1 ').trim();}
function fmtExp(el){let v=el.value.replace(/\D/g,'');if(v.length>=3)v=v.substring(0,2)+'/'+v.substring(2,4);el.value=v;}

// â”€â”€â”€ VALIDATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showErr(id){const e=document.getElementById(id);if(e){e.classList.add('show');setTimeout(()=>e.classList.remove('show'),3500);}}
function validate(n) {
  if(n===1){
    if(!S.serviceType){alert('Seleziona il tipo di servizio');return false;}
    if(!S.date){alert('Seleziona una data');return false;}
    if(!S.time){alert('Seleziona un orario');return false;}
  }
  if(n===2){
    const m=document.getElementById('modelInput').value.trim();
    if(!S.device){alert('Seleziona la categoria del dispositivo');return false;}
    if(!m){showErr('modelErr');return false;}
    S.model=m;
    S.serial=document.getElementById('serialInput').value.trim();
  }
  if(n===4){
    let ok=true;
    const fn=document.getElementById('fName').value.trim();
    const ln=document.getElementById('lName').value.trim();
    const em=document.getElementById('emailF').value.trim();
    const ph=document.getElementById('phoneF').value.trim();
    if(!fn){showErr('fNameErr');ok=false;}
    if(!ln){showErr('lNameErr');ok=false;}
    if(!em||!em.includes('@')||!em.includes('.')){showErr('emailErr');ok=false;}
    if(!ph||ph.replace(/\D/g,'').length<8){showErr('phoneErr');ok=false;}
    if(S.serviceType==='home'){
      const a=document.getElementById('addrF').value.trim();
      const c=document.getElementById('capF').value.trim();
      const ct=document.getElementById('cityF').value.trim();
      if(!a){showErr('addrErr');ok=false;}
      if(!c||c.length!==5){showErr('capErr');ok=false;}
      if(!ct){showErr('cityErr');ok=false;}
      if(ok){S.addr=a;S.cap=c;S.city=ct;S.courier=document.getElementById('courierF').value.trim();}
    }
    if(!document.getElementById('privCheck').checked){
      const el=document.getElementById('privCheck');
      el.closest('.check-wrap').style.outline='2px solid var(--error)';
      el.closest('.check-wrap').style.borderRadius='4px';
      el.closest('.check-wrap').style.padding='6px';
      document.getElementById('privErr').style.display='block';
      return false;
    }
    if(!ok)return false;
    S.fname=fn;S.lname=ln;S.email=em;S.phone=ph;
  }
  if(n===5){
    const cn=document.getElementById('cardNum').value.replace(/\s/g,'');
    const cn2=document.getElementById('cardName').value.trim();
    const ce=document.getElementById('cardExp').value;
    const cv=document.getElementById('cardCvv').value;
    let ok=true;
    if(cn.length<13||cn.length>16){showErr('cardNumErr');ok=false;}
    if(!cn2){showErr('cardNameErr');ok=false;}
    if(!ce||ce.length<5){showErr('cardExpErr');ok=false;}
    if(!cv||cv.length<3){showErr('cardCvvErr');ok=false;}
    if(!ok)return false;
  }
  return true;
}

// â”€â”€â”€ STEP NAV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function next(n) {
  if(n>S.step&&!validate(S.step))return;
  document.querySelectorAll('.step-panel').forEach(p=>p.classList.remove('active'));
  const id=n<=6?'step'+n:'stepOK';
  document.getElementById(id).classList.add('active');
  S.step=n;
  updateBar(n);
  document.getElementById('pb').style.width=(PROG[n]||100)+'%';
  window.scrollTo({top:0,behavior:'smooth'});
  if(n===3)renderProbs();
  if(n===6)renderRecap();
}
function updateBar(n) {
  for(let i=1;i<=6;i++){
    const el=document.getElementById('si'+i);
    if(!el)continue;
    el.classList.remove('active','done');
    if(i<n)el.classList.add('done');
    else if(i===n)el.classList.add('active');
  }
}

// â”€â”€â”€ RECAP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderRecap() {
  const rows=[
    ['Servizio',S.serviceType==='store'?'ğŸª In negozio':'ğŸš Ritiro a domicilio'],
    ['Data / Orario',S.date+' alle '+S.time],
    ['Dispositivo',S.device+' â€” '+S.model],
    S.serial?['Seriale/IMEI',S.serial]:null,
    ['Problema',S.problems.length?S.problems.join(', '):'Da definire in diagnosi'],
    ['Garanzia',S.warranty?'âœ“ In garanzia':'Fuori garanzia'],
    ['Cliente',S.fname+' '+S.lname],
    ['Email',S.email],
    ['Telefono',S.phone],
    S.serviceType==='home'?['Indirizzo',S.addr+', '+S.cap+' '+S.city+(S.courier?' ('+S.courier+')':'')]:null,
    ['Notifiche',S.wa?'ğŸ“§ Email + ğŸ’¬ WhatsApp':'ğŸ“§ Solo email'],
    ['Pagamento','ğŸ’³ Carta salvata Â· Addebito solo a riparazione ultimata'],
  ].filter(Boolean);
  document.getElementById('recapGrid').innerHTML=rows.map(([k,v])=>`
    <div class="recap-row"><div class="recap-k">${k}</div><div class="recap-v">${v}</div></div>`).join('');
}

// â”€â”€â”€ CONFIRM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// â”€â”€â”€ N8N WEBHOOK URL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Incolla qui l'URL del tuo webhook n8n dopo averlo creato.
// Esempio: 'https://tuonome.app.n8n.cloud/webhook/samsung-repairs'
const N8N_WEBHOOK_URL = 'INSERISCI_QUI_URL_WEBHOOK_N8N';

function confirm() {
  const btn = document.getElementById('btnConfirm');
  btn.textContent = 'â³ Invio prenotazione...';
  btn.disabled = true;

  // Costruisce il codice prenotazione lato client
  // (n8n lo salverÃ  su Supabase, qui lo usiamo solo per mostrarlo subito)
  const code = 'SR-' + new Date().getFullYear() + '-' + Math.floor(Math.random() * 9000 + 1000);

  // Payload completo da inviare a n8n â†’ Supabase + Brevo + Twilio + Google Sheets
  const payload = {
    code,
    submitted_at:   new Date().toISOString(),

    // Servizio
    service_type:   S.serviceType,
    date:           S.date,
    time:           S.time,

    // Dispositivo
    device_category: S.device,
    device_model:    S.model,
    device_serial:   S.serial || null,

    // Problema
    problems:        S.problems,
    description:     document.getElementById('probDesc').value.trim() || null,
    warranty:        S.warranty,

    // Cliente
    first_name:      S.fname,
    last_name:       S.lname,
    email:           S.email,
    phone:           S.phone,
    whatsapp_opt_in: S.wa,

    // Indirizzo (solo se domicilio)
    address:         S.serviceType === 'home' ? S.addr  : null,
    cap:             S.serviceType === 'home' ? S.cap   : null,
    city:            S.serviceType === 'home' ? S.city  : null,
    courier_notes:   S.serviceType === 'home' ? S.courier : null,
  };

  // Se non Ã¨ ancora stato configurato l'URL, mostra avviso e simula il successo
  // (utile durante il setup iniziale su Vercel)
  if (N8N_WEBHOOK_URL === 'INSERISCI_QUI_URL_WEBHOOK_N8N') {
    console.warn('âš ï¸ N8N_WEBHOOK_URL non configurato â€” modalitÃ  demo attiva.');
    console.log('Payload che verrÃ  inviato a n8n:', JSON.stringify(payload, null, 2));
    showSuccess(code);
    return;
  }

  fetch(N8N_WEBHOOK_URL, {
    method:  'POST',
    headers: { 'Content-Type': 'application/json' },
    body:    JSON.stringify(payload),
  })
  .then(res => {
    if (!res.ok) throw new Error('Risposta server: ' + res.status);
    return res.json().catch(() => ({})); // n8n puÃ² rispondere con body vuoto
  })
  .then(() => {
    showSuccess(code);
  })
  .catch(err => {
    console.error('Errore invio webhook:', err);
    btn.textContent = 'âœ… Conferma Prenotazione â€” Paga dopo la riparazione';
    btn.disabled = false;
    // Mostra errore inline senza alert
    const errBox = document.getElementById('webhookErr');
    if (errBox) errBox.style.display = 'block';
  });
}

function showSuccess(code) {
  document.getElementById('bookCode').textContent = code;
  const isH = S.serviceType === 'home';
  document.getElementById('ns1t').textContent = isH
    ? `Il nostro corriere passerÃ  a ritirare il tuo ${S.device} il ${S.date} alle ${S.time}.`
    : `Portaci il tuo ${S.device} in negozio il ${S.date} alle ${S.time}. Via Monza 1, Cologno Monzese.`;
  document.getElementById('ns5t').textContent = isH
    ? 'Il dispositivo riparato verrÃ  riconsegnato al tuo indirizzo entro 24â€“48h dal completamento.'
    : 'Puoi ritirare il dispositivo riparato in negozio. Ti avviseremo via ' + (S.wa ? 'WhatsApp e email' : 'email') + ' quando Ã¨ pronto.';
  document.querySelectorAll('.step-panel').forEach(p => p.classList.remove('active'));
  document.getElementById('stepOK').classList.add('active');
  document.querySelectorAll('.step-item').forEach(s => { s.classList.remove('active'); s.classList.add('done'); });
  document.getElementById('pb').style.width = '100%';
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// â”€â”€â”€ CLEAR ERRORS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.addEventListener('DOMContentLoaded',()=>{
  initDates(); initTimes();
  document.querySelectorAll('input,select,textarea').forEach(el=>{
    el.addEventListener('input',()=>{
      el.classList.remove('error');
      const e=document.getElementById(el.id+'Err');
      if(e)e.classList.remove('show');
    });
  });
});
</script>
</body>
</html>
